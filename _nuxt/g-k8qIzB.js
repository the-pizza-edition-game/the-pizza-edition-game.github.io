import{_ as N,r as f,D as E,n as b,u as I,c as r,a,j as G,q as s,b as i,t as u,i as p,d as c,P,w as B,F as V,p as O,e as U,o as n,h as $,k as q}from"./CT4rAdE5.js";import{u as R}from"./DOX7jYxd.js";const T={class:"offline-games-page"},j={key:0,class:"storage-card"},H={class:"storage-header"},K={class:"storage-info"},Q={class:"storage-text"},Y={class:"storage-used"},J=["disabled"],W={class:"storage-bar-container"},X={class:"storage-percentage"},Z={key:1,class:"loading-container"},ee={key:2,class:"empty-state"},ae={class:"empty-icon"},oe={key:3,class:"cached-games-grid"},te={class:"game-title"},se={class:"game-meta"},ne={class:"cached-date"},le={key:0,class:"game-size"},ie=["onClick","disabled"],re={class:"info-section"},ce={__name:"offline-games",setup(de){const{getCachedGames:x,uncacheGame:M,getStorageQuota:S,clearAllCaches:z}=R(),g=f([]),y=f(!0),d=f(null),h=f(!1),v=f(null);E(async()=>{await _(),await w()});const _=async()=>{y.value=!0;try{g.value=await x()}catch(o){console.error("Error loading cached games:",o)}finally{y.value=!1}},w=async()=>{try{d.value=await S()}catch(o){console.error("Error loading storage info:",o)}},A=async(o,e)=>{if(confirm(`Remove "${e}" from offline cache?`)){v.value=o;try{await M(o),await _(),await w()}catch(t){console.error("Error removing game:",t),alert("Failed to remove game from cache")}finally{v.value=null}}},D=async()=>{if(confirm("Clear all cached games? This will remove all offline content and you will need to re-cache games while online.")){h.value=!0;try{await z(),await _(),await w()}catch(o){console.error("Error clearing caches:",o),alert("Failed to clear caches")}finally{h.value=!1}}},k=o=>{if(!o||o===0)return"0 B";const e=1024,t=["B","KB","MB","GB"],m=Math.floor(Math.log(o)/Math.log(e));return parseFloat((o/Math.pow(e,m)).toFixed(2))+" "+t[m]},F=o=>new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),C=b(()=>d.value?Math.round(d.value.percentUsed):0),L=b(()=>{const o=C.value;return o>80?"#e74c3c":o>60?"#f1c40f":"#2ecc71"});return I({title:"Offline Games - PizaGame",meta:[{name:"description",content:"Manage your offline cached games. Play your favorite games even without internet connection."}]}),(o,e)=>{const t=$,m=U;return n(),r("div",T,[e[11]||(e[11]=a("div",{class:"page-header"},[a("h1",null,"Offline Games"),a("p",{class:"page-description"}," Games cached for offline play. Cache games while online to play them anywhere, anytime. ")],-1)),s(d)?(n(),r("div",j,[a("div",H,[a("div",K,[i(t,{name:"fa6-solid:hard-drive"}),a("div",Q,[a("div",Y,u(k(s(d).usage))+" / "+u(k(s(d).quota)),1),e[0]||(e[0]=a("div",{class:"storage-label"},"Storage Used",-1))])]),a("button",{onClick:D,class:"clear-all-btn",disabled:s(h)||s(g).length===0},[s(h)?(n(),p(t,{key:0,name:"fa6-solid:spinner",class:"spin-icon"})):(n(),p(t,{key:1,name:"fa6-solid:trash"})),e[1]||(e[1]=c(" Clear All ",-1))],8,J)]),a("div",W,[a("div",{class:"storage-bar",style:P({width:s(C)+"%",backgroundColor:s(L)})},null,4)]),a("div",X,u(s(C))+"% used",1)])):G("",!0),s(y)?(n(),r("div",Z,[i(t,{name:"fa6-solid:spinner",class:"spin-icon loading-icon"}),e[2]||(e[2]=a("p",null,"Loading cached games...",-1))])):s(g).length===0?(n(),r("div",ee,[a("div",ae,[i(t,{name:"fa6-solid:download"})]),e[4]||(e[4]=a("h2",null,"No Cached Games Yet",-1)),e[5]||(e[5]=a("p",null," Cache games while online to play them offline. Look for the download button when playing any game! ",-1)),i(m,{to:"/",class:"btn-primary"},{default:B(()=>[...e[3]||(e[3]=[c("Browse Games",-1)])]),_:1})])):(n(),r("div",oe,[(n(!0),r(V,null,O(s(g),l=>(n(),r("div",{key:l.slug,class:"cached-game-card"},[i(m,{to:`/games/${l.slug}`,class:"game-link"},{default:B(()=>[a("div",te,u(l.title),1),a("div",se,[a("div",ne,[i(t,{name:"fa6-solid:clock"}),c(" "+u(F(l.cachedAt)),1)]),l.size?(n(),r("div",le,u(k(l.size)),1)):G("",!0)])]),_:2},1032,["to"]),a("button",{onClick:q(ue=>A(l.slug,l.title),["prevent"]),class:"remove-btn",disabled:s(v)===l.slug,title:"Remove from offline cache"},[s(v)===l.slug?(n(),p(t,{key:0,name:"fa6-solid:spinner",class:"spin-icon"})):(n(),p(t,{key:1,name:"fa6-solid:trash"}))],8,ie)]))),128))])),a("div",re,[e[10]||(e[10]=a("h3",null,"About Offline Games",-1)),a("ul",null,[a("li",null,[i(t,{name:"fa6-solid:check-circle"}),e[6]||(e[6]=c(" Cached games are available even without internet connection ",-1))]),a("li",null,[i(t,{name:"fa6-solid:check-circle"}),e[7]||(e[7]=c(" Cache limits depend on your device's available storage ",-1))]),a("li",null,[i(t,{name:"fa6-solid:check-circle"}),e[8]||(e[8]=c(" Some games may not work fully offline due to external dependencies ",-1))]),a("li",null,[i(t,{name:"fa6-solid:check-circle"}),e[9]||(e[9]=c(" Clearing browser data will remove all cached games ",-1))])])])])}}},ge=N(ce,[["__scopeId","data-v-60cbfc23"]]);export{ge as default};
